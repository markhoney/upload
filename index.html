<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width,initial-scale=1.0">
		<title>Upload test</title>
		<link href="https://unpkg.com/tailwindcss/dist/tailwind.min.css" rel="stylesheet">
		<script src="https://unpkg.com/vue/dist/vue.js"></script>
		<script lang="javascript" src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
		<script src="main.js" type="module"></script>
	</head>
	<body>
		<div id="app">
			<div class="border border-dashed border-gray-500 relative">
				<input ref="import" type="file" @input="upload" class="cursor-pointer relative block opacity-0 w-full h-full p-20 z-50">
				<div class="text-center p-10 absolute top-0 right-0 left-0 m-auto">
					<h4>
						Drop a file here to upload
						<br/>or
					</h4>
					<p>Click to select a file</p>
				</div>
			</div>
			<div class="flex flex-col items-center mx-16">
				<div class="flex my-8">
					<div class="custom-number-input h-10 w-64">
						<label for="custom-input-number" class="w-full text-gray-700 text-sm font-semibold">Numeric cell multiplier</label>
						<div class="flex flex-row h-10 w-32 rounded-lg relative bg-transparent mt-1">
							<button @click="multiplier -= 1" class="bg-gray-300 text-gray-600 hover:text-gray-700 hover:bg-gray-400 h-full w-20 rounded-l cursor-pointer outline-none"><span class="m-auto text-2xl font-thin">âˆ’</span></button>
							<input type="number" v-model="multiplier" class="outline-none focus:outline-none text-center w-full bg-gray-300 font-semibold text-md hover:text-black focus:text-black md:text-basecursor-default flex items-center text-gray-700 outline-none" name="custom-input-number" value="0"></input>
							<button @click="multiplier += 1" class="bg-gray-300 text-gray-600 hover:text-gray-700 hover:bg-gray-400 h-full w-20 rounded-r cursor-pointer"><span class="m-auto text-2xl font-thin">+</span></button>
						</div>
					</div>
					<div class="append h-10 w-64">
						<label for="append" class="w-64 text-gray-700 text-sm font-semibold">Append text to all cells</label>
						<input type="text" v-model="append" class="shadow appearance-none border rounded py-2 px-3 text-grey-darker">
					</div>
				</div>
				<div v-if="output && output.length" class="mt-16 mb-8">
					<button class="w-32 bg-gray-300 hover:bg-grey text-grey-900 font-bold py-2 px-4 rounded inline-flex items-center" @click="download">
						<svg class="w-4 h-4 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M13 8V2H7v6H2l8 8 8-8h-5zM0 18h20v2H0v-2z"/></svg>
						<span>Download</span>
					</button>
				</div>
				<table class="w-full text-md bg-white shadow-md rounded">
					<thead>
						<tr class="bg-gray-200">
							<th class="text-left p-3 px-5" v-for="(data, column) in output[0]">{{column}}</th>
						</tr>
					</thead>
					<tbody>
						<tr v-for="(row, index) in output" class="border-b hover:bg-orange-100" :class="[index % 2 ? 'bg-gray-100' : 'bg-white']">
							<td v-for="data in row" class="p-3 px-5">{{data}}</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</body>
</html>
